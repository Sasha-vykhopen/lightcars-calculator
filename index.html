<!doctype html>
<html lang="uk">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LIGHTCARS — калькулятор витрат (editable, dark)</title>
<style>
  :root{
    --bg:#0b0d10; --card:#12151b; --panel:#171b23; --text:#f5f7fb; --muted:#aab3c2;
    --line:rgba(255,255,255,.10); --brand:#e11d48; --cyan:#22d3ee;
    --radius:16px; --shadow:0 12px 36px rgba(0,0,0,.38)
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--text);
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  .wrap{max-width:1060px;margin:28px auto 96px;padding:16px}
  .glass{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));
    border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow)}
  header.brand{display:flex;gap:16px;align-items:center;padding:16px}
  .logo{width:84px;height:84px;border-radius:16px;overflow:hidden;border:1px solid var(--line);
    background:#0f131a;display:grid;place-items:center;cursor:pointer}
  .logo img{width:100%;height:100%;object-fit:cover}
  .headline h1{margin:0;letter-spacing:.3px}
  .headline .sub{color:var(--muted)}
  .badge{margin-left:auto;background:rgba(34,211,238,.14);border:1px dashed var(--line);
    padding:6px 10px;border-radius:999px}
  .hero{margin-top:12px}
  /* більший банер */
  .hero img{width:100%;aspect-ratio:16/3;object-fit:cover;border-radius:16px;border:1px solid var(--line);background:#0f131a}

  .section{margin-top:14px;overflow:hidden}
  .section .head{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;
    background:linear-gradient(90deg,rgba(225,29,72,.18),rgba(34,211,238,.10))}
  table{width:100%;border-collapse:separate;border-spacing:0;background:var(--card)}
  thead th{font-weight:700;text-align:left;font-size:.95rem;padding:12px 14px;border-bottom:1px solid var(--line)}
  tbody td{padding:10px 14px;border-bottom:1px dashed var(--line);vertical-align:middle}
  tbody tr:last-child td{border-bottom:none}
  .subhead td{background:rgba(255,255,255,.04);font-weight:700;letter-spacing:.3px}
  .label{display:flex;align-items:center;gap:10px}
  .dot{width:10px;height:10px;border-radius:50%;background:var(--cyan);box-shadow:0 0 0 4px rgba(34,211,238,.12)}
  .right{text-align:right} .muted{color:var(--muted)}
  .value{min-width:120px;display:inline-block;text-align:right}
  .input{display:none;width:140px;text-align:right;background:#0c0f15;border:1px solid var(--line);
         color:var(--text);padding:9px 10px;border-radius:10px}
  .mini{background:transparent;border:1px solid var(--line);color:var(--text);
        border-radius:12px;padding:6px 10px;cursor:pointer}
  .mini:hover{background:rgba(255,255,255,.06)}
  .pill{font-size:.75rem;padding:4px 8px;border-radius:999px;border:1px solid var(--line);opacity:.7}

  .sumbar{position:sticky;bottom:16px;display:grid;grid-template-columns:repeat(3,1fr);gap:12px;padding:12px}
  .kpi{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:14px}
  .kpi b{font-size:1.35rem}
  .tools{display:flex;gap:10px;padding:12px 16px;border-top:1px dashed var(--line)}
  .btn{background:transparent;color:var(--text);border:1px solid var(--line);border-radius:12px;padding:10px 14px;cursor:pointer;font-weight:700}
  .btn:hover{background:rgba(255,255,255,.06)}
  @media print{ .sumbar{position:static} .tools{display:none} header.brand .badge{display:none}}
</style>
</head>
<body>
<div class="wrap">
  <header class="brand glass">
    <div class="logo" id="logoBox" title="Клік — перемкнути лого 1/2">
      <img id="logo" src="logo1.jpg" alt="LIGHTCARS"
           onerror="this.remove();this.parentElement.innerHTML='<b>LIGHTCARS</b>'">
    </div>
    <div class="headline">
      <h1>LIGHTCARS — калькулятор витрат</h1>
      <div class="sub">Клікни «Змінити» в рядку, введи суму — підсумок порахується внизу.</div>
    </div>
    <span class="badge">American Auto Import</span>
  </header>

  <!-- Опційний банер (hero.jpg у тій самій папці) -->
  <div class="hero"><img id="hero" src="hero.jpg" alt=" " onerror="this.remove();"></div>

  <section class="section glass">
    <div class="head">
      <strong>Статті витрат</strong>
      <span class="muted">Натисни «Змінити» у рядку, щоб ввести суму</span>
    </div>

    <table>
      <thead>
        <tr><th>Позиція</th><th class="right">Сума, $</th><th class="right">Дія</th></tr>
      </thead>
      <tbody id="rows"></tbody>
    </table>

    <div class="sumbar">
      <div class="kpi"><div class="muted">Разом, $</div><b id="sumUsd" class="right">0.00</b></div>
      <div class="kpi"><div class="muted">Курс UAH/USD</div><input id="rate" type="number" step="0.01" value="41" class="input" style="display:block"></div>
      <div class="kpi"><div class="muted">Разом, ₴</div><b id="sumUah" class="right">0.00</b></div>
    </div>

    <div class="tools">
      <button id="print" class="btn">Друк / PDF</button>
    </div>
  </section>
</div>

<script>
  // type: 'user' (ручне), 'auto' (формула), 'group' (підзаголовок)
  const LINES = [
    ['group', 'Базові параметри'],
    ['user','lot','Вартість лоту',0],
    ['user','auction','Аукціонний збір',0],
    ['user','land','Доставка суша',0],
    ['user','sea','Доставка море',0],

    ['group', 'Автоматично розраховується'],
    ['auto','swift','SWIFT переказ в США', s => (num(s.lot)+num(s.auction))*0.035 ],
    ['auto','insurance','Страхівка',       s => num(s.lot)*0.02 ],

    ['group', 'Оформлення та сервіс'],
    ['user','service','Послуги компанії',500],
    ['user','expedition','Експедиція (документи на експорт, вивантаження)',300],
    ['user','load','Погрузка авто',90],
    ['user','lviv','Доставка до Львова',550],
    ['user','broker','Брокерські послуги',150],
    ['user','customs','Мито',0],
  ];

  const tbody = document.getElementById('rows');
  const state = {};
  function num(v){ v=+v; return isNaN(v)?0:v; }
  function fmt(v){ return num(v).toFixed(2); }

  // завжди стартуємо з 0 для базових полів (ігноруємо збережене)
  function saved(key, def){
    const forceZero = ['lot','auction','land','sea']; // ці завжди 0 при відкритті
    if (forceZero.includes(key)) {
      localStorage.removeItem('lc_'+key);
      return 0;
    }
    const s = localStorage.getItem('lc_'+key);
    return s===null ? def : (s==='' ? 0 : +s);
  }

  // Побудова таблиці
  LINES.forEach(([type,key,label,val])=>{
    if(type==='group'){
      const tr=document.createElement('tr'); tr.className='subhead';
      tr.innerHTML=`<td colspan="3">${label||''}</td>`; tbody.appendChild(tr); return;
    }
    if(type==='user'){ state[key]=saved(key,val); }
    const tr=document.createElement('tr'); tr.dataset.key=key; tr.dataset.type=type;
    const initialView = (type==='auto') ? '' : fmt(state[key]);
    tr.innerHTML = `
      <td><div class="label"><span class="dot"></span><span>${label||''}</span></div></td>
      <td class="right">
        <span class="value" data-view>${initialView}</span>
        <input class="input" data-edit type="number" step="0.01" min="0" value="${type==='user'?state[key]:''}">
      </td>
      <td class="right">
        ${type==='user' ? `<button class="mini action-edit">Змінити</button>` : `<span class="pill">авто</span>`}
      </td>
    `;
    tbody.appendChild(tr);
  });

  // Редагування
  function showEditor(tr){
    const edit=tr.querySelector('[data-edit]'); const view=tr.querySelector('[data-view]');
    if(!edit) return; edit.style.display='inline-block'; view.style.display='none'; edit.focus(); edit.select();
  }
  function showValue(tr,val){
    const edit=tr.querySelector('[data-edit]'); const view=tr.querySelector('[data-view]');
    if(edit){ edit.style.display='none'; view.style.display='inline-block'; view.textContent = fmt(val); }
  }
  tbody.addEventListener('click',(e)=>{ const tr=e.target.closest('tr'); if(!tr) return;
    if(e.target.classList.contains('action-edit')) showEditor(tr);
  });
  tbody.addEventListener('keydown',(e)=>{ if(e.key==='Enter' && e.target.matches('[data-edit]')) e.target.blur(); });
  tbody.addEventListener('blur',(e)=>{
    if(!e.target.matches('[data-edit]')) return;
    const tr=e.target.closest('tr'); const key=tr.dataset.key; const v=+e.target.value||0;
    state[key]=v; localStorage.setItem('lc_'+key, String(v)); showValue(tr,v); recalc();
  }, true);

  // Підрахунки
  const sumUsd=document.getElementById('sumUsd');
  const sumUah=document.getElementById('sumUah');
  const rate=document.getElementById('rate');

  function recalc(){
    // авто-рядки
    LINES.forEach(([type,key,label,fn])=>{
      if(type!=='auto') return;
      const val = fn(state); state[key]=num(val);
      const tr=tbody.querySelector(`tr[data-key="${key}"]`);
      if(tr){ tr.querySelector('[data-view]').textContent = fmt(state[key]); }
    });
    // підсумок
    let total=0;
    LINES.forEach(([type,key])=>{ if(type!=='group'){ total += num(state[key]); } });
    sumUsd.textContent = fmt(total);
    sumUah.textContent = fmt(total * (parseFloat(rate.value)||0));
  }
  rate.addEventListener('input', recalc);
  recalc();

  // Друк
  document.getElementById('print').addEventListener('click', ()=>window.print());

  // Перемикання логотипів (опційно поклади logo1.jpg/logo2.jpg)
  const box=document.getElementById('logoBox'), img=document.getElementById('logo');
  let cur=1; box?.addEventListener('click',()=>{ if(!img) return; cur=cur===1?2:1; img.src='logo'+cur+'.jpg'; });
</script>
</body>
</html>
